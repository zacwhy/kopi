<!doctype html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Orders</title>
  </head>
  <body>
    <form id="order">
      <input id="party" placeholder="Name" required />
      <select id="product" required></select>
      <button>Order</button>
    </form>
    <pre id="json"></pre>
    <button id="addProduct">Add product</button>

    <script src="/socket.io/socket.io.js"></script>
    <script>
init();

function init() {
  const socket = io();

  socket.on('products', products => {
    const select = document.getElementById('product');
    select.options.length = 0;
    [''].concat(products).forEach(product => {
      const option = document.createElement('option');
      option.value = product;
      option.innerHTML = product;
      select.appendChild(option);
    });
  });

  socket.on('orders', orders => {
    document.getElementById('json').innerHTML = JSON.stringify(orders, undefined, 2);
  });

  document.getElementById('addProduct').onclick = () => {
    const name = prompt('Product name');
    if (name !== null) {
      socket.emit('product', name);
    }
  };

  document.getElementById('order').onsubmit = () => {
    const
      party = document.getElementById('party').value,
      product = document.getElementById('product').value;
    socket.emit('order', party, product);
    return false;
  };
}
    </script>
  </body>
</html>
